typedef UINT64 ULONGLONG;
typedef UINT32 ULONG;
typedef UINT16 USHORT;
typedef UINT8 BYTE;
typedef UINT8 UCHAR;

extern probe ProbeAndCopy
extern probe (READ UINT32) ProbeAndReadU32
extern probe (WRITE UINT64) WriteU64
extern probe (INIT) ProbeInit
extern PURE UINT64 UlongToPtr(UINT32 ptr)

aligned
typedef struct _LFD_64
{
    UINT32 Base;

    USHORT f1;
    USHORT f2;
    USHORT f3;
  
    UNINTERPRETED *ptr1;
    UNINTERPRETED *ptr2;
    UNINTERPRETED *ptr3;

    USHORT f4;
    USHORT f5;

} LFD64;

typedef struct _PLFD(EVERPARSE_COPY_BUFFER_T out)
{
    LFD64 *pointer(UINT64) plog
        probe ProbeAndCopy(length=sizeof(LFD_64), destination=out);
} PLFD;

specialize (pointer(UINT64), pointer(UINT32)) PLFD PLFD32;

entrypoint
casetype _LFD(Bool Requestor32, EVERPARSE_COPY_BUFFER_T out)
{
    switch(Requestor32)
    {
        case true:
            PLFD32(out) log32;
        default:
            PLFD(out) log64;
    }
} LFD;